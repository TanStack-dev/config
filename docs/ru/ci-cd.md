---
source-updated-at: '2025-03-04T06:01:52.000Z'
translation-updated-at: '2025-05-06T20:44:16.329Z'
id: ci-cd
title: CI/CD
---
## GitHub Workflows

- `pr.yml`:
    - Запускает тесты для всех pull request'ов
    - Запускает `nx affected`, который выполняет только задачи с невалидным кешем
    - Также использует `pkg-pr-new` для публикации превью пакетов и создания ссылок на примеры
- `release.yml`:
    - Запускает тесты для кода, влитого в релизные ветки
    - Запускает `nx run-many`, который выполняет все задачи и гарантирует наличие выходных данных (необходимо для публикации сборок)
    - Использует [Changesets](https://github.com/changesets/changesets) для управления версионированием и публикацией

## Nx

Проекты TanStack используют Nx для быстрого выполнения тестов и сборок. Задачи параллелизируются и кешируются как локально, так и в CI (Continuous Integration). Хотя Nx обладает обширной системой плагинов, мы используем его только как NPM-раннер скриптов.

### Конфигурационные файлы

- `./nx.json`: Основной конфигурационный файл, определяющий зависимости задач, входные и выходные данные
- `./package.json`: Необходимо вручную указывать скрипты корневого уровня (например, `test:format`)
- `./**/package.json`: Скрипты на уровне пакетов (например, `build`) определяются автоматически

### Nx Agents

- Nx позволяет распределять задачи между несколькими CI-машинами, увеличивая количество параллельно выполняемых задач
- Обратите внимание, что это приводит к значительной задержке при старте
